<!-- OPENSPEC:START -->
# OpenSpec Instructions

These instructions are for AI assistants working in this project.

Always open `@/openspec/AGENTS.md` when the request:
- Mentions planning or proposals (words like proposal, spec, change, plan)
- Introduces new capabilities, breaking changes, architecture shifts, or big performance/security work
- Sounds ambiguous and you need the authoritative spec before coding

Use `@/openspec/AGENTS.md` to learn:
- How to create and apply change proposals
- Spec format and conventions
- Project structure and guidelines

Keep this managed block so 'openspec update' can refresh the instructions.

<!-- OPENSPEC:END -->

# AGENTS.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a personal portfolio website built with Hugo static site generator using the Hugo Advance theme. The site is deployed to craigearley.software and includes a serverless AWS backend for API functionality.

### Architecture

- **Frontend**: Hugo static site generator with Hugo Advance theme
- **Content**: Markdown files in `content/en/` + private content via Hugo Modules
- **Deployment**: GitHub Pages via GitHub Actions + AWS SAM (backend API)
- **Theme**: Imported via Hugo Modules from `github.com/cearley/private-hugo-theme`
- **Private Content**: Imported via Hugo Modules from `github.com/cearley/private-content`

### Hugo Modules

This site uses Hugo Modules to import content from private repositories:

| Module | Purpose | Mounts To |
|--------|---------|-----------|
| `private-hugo-theme` | Licensed Hugo Advance theme | Theme |
| `private-content` | Blog posts, portfolio, case studies | `content/en/posts`, `content/en/portfolio/github`, `content/en/work` |

See `docs/PRIVATE-CONTENT.md` for full documentation.

## Development Commands

### Hugo Site
```bash
# Install Hugo (macOS)
brew install hugo

# Development server
hugo server

# Build static site
hugo

# Build with environment
hugo --environment production
```

### Hugo Modules
```bash
# Update all modules (theme + content)
hugo mod get -u

# Update specific module
hugo mod get -u github.com/cearley/private-content

# Show module dependency graph
hugo mod graph

# Verify modules
hugo mod verify
```

### Development Workflows

**Updating content (from private-content repo):**
1. Make changes in `github.com/cearley/private-content`
2. Commit and push to private-content
3. In this repo: `hugo mod get -u`
4. Test locally: `hugo server`
5. Commit updated `go.mod` and `go.sum`
6. Create a release to deploy (see Deployment section)

**Updating site (config, layouts, static files):**
1. Edit files directly in this repo
2. Test locally: `hugo server`
3. Commit and push
4. Create a release to deploy (see Deployment section)

**Local development with content changes:**
Add a replace directive to `go.mod` for local development:
```
replace github.com/cearley/private-content => /path/to/local/private-content
```
Remove before committing.

### AWS SAM Backend
```bash
# Build SAM application
cd backend && sam build

# Deploy with guided setup
sam deploy --guided

# Test locally
sam local start-api

# Invoke function locally
sam local invoke HelloWorldFunction --event events/event.json

# Run tests
cd hello-world && npm install && npm test

# View logs
sam logs -n HelloWorldFunction --stack-name backend --tail
```

## Content Structure

### Main Content Directory (`content/`)

**Local content (this repo):**
- `authors/` - Author profiles and information
- `contact/` - Contact page and success message page
- `pages/` - Static pages (about, disclaimer, privacy policy, terms and conditions)
- `portfolio/design/` - Design work samples
- `portfolio/research/` - Research projects and publications
- `services/` - Service offerings
- `team/` - Team member profiles and bios

**Mounted from private-content (via Hugo Modules):**
- `posts/` - Blog articles (from `articles/*`)
- `portfolio/github/` - GitHub projects (from `portfolio/projects`)
- `work/` - Case studies (from `portfolio/case-studies`)

### Supporting Directories
- `data/` - JSON data files (partners.json, social.json)
- `static/` - Static assets:
  - `images/` - Site images and media
  - `favicon.ico` - Site favicon
  - `CNAME` - Custom domain configuration
- `public/` - Generated site output (auto-generated by Hugo)

## Configuration

- `config.toml` - Main Hugo configuration
- `.github/workflows/hugo.yaml` - GitHub Actions workflow for GitHub Pages deployment (Hugo v0.154.0)
- `.github/workflows/codeql.yaml` - GitHub Actions workflow for CodeQL security analysis
- `backend/template.yaml` - AWS SAM CloudFormation template

## Backend API

### AWS SAM Application Structure
The serverless backend is defined in `backend/template.yaml` and includes:

**AWS Resources:**
- **S3 Bucket** (`FrontendBucket`) - Hosts static website content
- **CloudFront Distribution** - CDN for content delivery and API routing
- **Lambda Function** (`HelloWorldFunction`) - Serverless backend logic
- **API Gateway** (`ServerlessRestApi`) - HTTP endpoint exposure

**Lambda Function Details:**
- Handler: `backend/hello-world/app.mjs`
- Runtime: Node.js 20.x
- Current endpoint: `/hello` (GET) - Returns simple "hello world" JSON response
- Tests: `backend/hello-world/tests/`
- Entry point: `lambdaHandler` function triggered by API Gateway events

## Theme Customization

The Hugo Advance theme supports:
- Dark mode (enabled in config)
- Custom colors and fonts
- Nested menus
- Fixed header with scroll animation

## Deployment

- **Frontend**: Deploys to GitHub Pages via GitHub Actions when a release is published
- **Backend**: Manual deployment via `sam deploy` command
- **Domain**: craigearley.software (configured in CNAME file)

### Release Workflow

The site deploys only when a GitHub release is published (not on push to main).

**Creating a release:**
1. Update `CHANGELOG.md` - move entries from `[Unreleased]` to new version
2. Commit: `git commit -m "docs: prepare release v1.x.x"`
3. Create and push tag:
   ```bash
   git tag v1.x.x
   git push origin main
   git push origin v1.x.x
   ```
4. GitHub Actions automatically:
   - Creates a release with notes extracted from CHANGELOG.md
   - Deploys the site to GitHub Pages

**Deploying a specific version:**
1. Go to Actions â†’ "Deploy cearley.software site to Pages"
2. Click "Run workflow"
3. Enter the git ref (tag like `v1.0.0`, branch, or commit SHA)
4. Click "Run workflow"

## Content Management

### Content Format
All content is written in **Markdown with YAML frontmatter**. The site uses a structured approach with specific content types:

### Content Types and Organization
- **Posts**: Blog articles with categories, tags, and publication dates
- **Portfolio**: Organized into three main sections:
  - Design work samples and creative projects
  - GitHub repositories and open-source contributions  
  - Research projects and academic publications
- **Services**: Business service descriptions (Branding, Web Design)
- **Team**: Staff profiles with bios and role information
- **Work**: Detailed case studies and project documentation
- **Pages**: Standard website pages (About, Privacy Policy, Terms, etc.)
- **Authors**: Author profiles and contributor information
- **Contact**: Contact forms and success/thank you pages

### Site Architecture Notes
- **Hybrid Approach**: Static frontend with serverless backend for dynamic features
- **Modern Deployment**: GitHub Actions handles frontend CI/CD to GitHub Pages, AWS provides scalable API backend
- **Extensibility**: Current Lambda function is a template that can be extended for contact forms, analytics, or other interactive features
- **Performance**: CloudFront CDN ensures fast global content delivery